# Single-cell and Spatial Profiling of Histologic Subtypes in Lung Adenocarcinoma

This repository contains code and analysis pipelines for a study of the cellular and spatial architecture underlying histologic subtypes of lung adenocarcinoma (LUAD), based on single-cell RNA sequencing (scRNA-seq) and spatial transcriptomics (10x Visium).

---

## Summary

### Background
Tumor histology reflects disease aggressiveness and clinical outcomes in cancer patients. Lung adenocarcinomas (LUADs) are classified based on predominant histologic patterns, including high-grade micropapillary and solid subtypes, which are associated with unfavorable clinical features and prognosis. However, the cellular and molecular features underlying these histologic subtypes remain poorly understood.

### Methods
We used scRNA-seq and spatial transcriptomics (10x Visium) to profile **117,266 cells** from **18 treatment-na√Øve LUADs** with heterogeneous histologic patterns. By integrating single-cell transcriptional states with spatial information, we characterized the cellular identity and spatial organization driving LUAD heterogeneity.

### Results
Our analyses show that histologic subtypes can be distinguished by:

- subtype-specific cancer cell subpopulations, and  
- immunosuppressive phenotypes in the tumor microenvironment (TME).

We dissect intercellular interactions among cancer cells, macrophages, and CD8‚Å∫ T cells in the prognostically unfavorable solid subtype, revealing how these interactions drive cancer cell plasticity and promote an immunosuppressive TME. Furthermore, we identify **HMGA1** as a potential clinically relevant biomarker and therapeutic target for solid-subtype LUAD.

### Conclusions
These findings deepen our understanding of the histologic heterogeneity of LUAD and may facilitate the development of subtype-specific biomarkers and targeted therapeutic strategies.

---

## Repository Structure

This repository is organized into the following main components (folder names can be adjusted to your repo structure):

- `data/`  
  - Small example data and metadata (non-sensitive / de-identified) to demonstrate the pipeline.  
  - **Note:** Full raw and processed data are hosted externally (see *Data availability* below).

- `scripts/`  
  - Analysis scripts for scRNA-seq preprocessing, spatial analysis, intercellular interaction analysis, and figure generation.  
  - (Script list and descriptions can be added here as the repository is finalized.)

- `env/`  
  - Example conda environment files or `renv`/`packrat` configuration for reproducible environments (R and Python).

- `figures/`  
  - Output figures (low-resolution or example plots) generated by the analysis pipeline.

---

## Interactive Data Exploration (cellxgene)

Interactive visualization of selected processed datasets is available via **cellxgene**:

- LUAD single-cell atlas (this study):  
  üëâ [Open in cellxgene](<CELLXGENE_LINK>)

Through the cellxgene interface, users can:
- explore cell type and subtype annotations,  
- view expression of key marker genes and HMGA1,  
- inspect distributions across histologic subtypes and samples.

(Replace `<CELLXGENE_LINK>` with your actual URL once available.)

---

## Requirements

The analysis uses both **R** and **Python**.

### R

- R ‚â• 4.4  
- Core packages (non-exhaustive):
  - `Seurat`, `SeuratObject`
  - `Harmony`
  - `dplyr`, `data.table`
  - `ggplot2`, `patchwork`
  - `SingleR` (or other annotation tools)

### Python

- Python ‚â• 3.9  
- Core packages (non-exhaustive):
  - `scanpy`, `anndata`
  - `numpy`, `pandas`
  - `matplotlib`, `seaborn`
  - `scikit-learn`

Environment files (e.g. `env/environment.yml`, `requirements.txt`, or `renv.lock`) provide more precise version information if available.

---

## Installation (minimal)

```bash
git clone https://github.com/<YOUR-ORG>/<YOUR-REPO>.git
cd <YOUR-REPO>
# Example: using conda
conda env create -f env/environment.yml
conda activate luad-histology
